//
// Matrices for converting to and from an order-7 Bezier.
//


// Matrices for approximating order-7 Bezier by lower order Bezier

const float kBezier7To6[7][8] = 
{
    {  0.9997f, 0.002035f, -0.006123f, 0.01019f, -0.0102f, 0.006123f, -0.002036f, 0.0002947f },
    { -0.1642f,    1.15f, 0.05098f,  -0.085f, 0.08496f, -0.05102f, 0.01697f, -0.002445f },
    { 0.05714f, -0.3999f,     1.2f,  0.3339f, -0.3338f,  0.2004f, -0.06673f, 0.009561f },
    { -0.02501f,   0.175f,  -0.525f,  0.8749f,   0.875f, -0.5251f,   0.175f, -0.02501f },
    { 0.009544f, -0.06675f,  0.2003f, -0.3338f,  0.3338f,     1.2f, -0.3999f, 0.05712f },
    { -0.002431f, 0.01699f,  -0.051f, 0.08498f, -0.08499f, 0.05099f,    1.15f, -0.1642f },
    { 0.0002921f, -0.002039f, 0.00612f, -0.0102f,  0.0102f, -0.006118f, 0.002039f,  0.9997f }
};

const float kBezier7To5[6][8] = 
{
    {  0.9959f, 0.02098f, -0.04021f, 0.02914f, 0.008741f, -0.02797f,  0.0169f, -0.003495f },
    {  -0.369f,   1.239f,  0.3147f, -0.2442f, -0.03613f,  0.1899f, -0.1193f, 0.02505f },
    {   0.185f, -0.7932f,  0.8752f,   1.049f, -0.05652f, -0.5615f,  0.3857f, -0.08344f },
    { -0.08345f,  0.3857f, -0.5615f, -0.05653f,   1.049f,  0.8752f, -0.7932f,   0.185f },
    { 0.02506f, -0.1193f,  0.1899f, -0.03613f, -0.2442f,  0.3147f,   1.239f,  -0.369f },
    { -0.003497f,  0.0169f, -0.02797f, 0.008742f, 0.02914f, -0.04021f, 0.02098f,  0.9959f }
};

const float kBezier7To4[5][8] = 
{
    {  0.9735f,  0.0947f, -0.0947f, -0.01894f, 0.05682f, 0.02652f, -0.05682f, 0.01894f },
    { -0.5644f,   1.064f,  0.7576f, -2.012e-06f, -0.3599f, -0.1098f,  0.3258f, -0.1136f },
    {  0.3106f,  -0.803f, 0.04546f,   0.947f,   0.947f, 0.04546f,  -0.803f,  0.3106f },
    { -0.1136f,  0.3258f, -0.1098f, -0.3598f, -5.364e-07f,  0.7576f,   1.064f, -0.5644f },
    { 0.01894f, -0.05682f, 0.02652f, 0.05682f, -0.01894f, -0.0947f,  0.0947f,  0.9735f }
};

const float kBezier7To3[4][8] = 
{
    {  0.8939f,  0.2424f, -0.06061f, -0.1212f, -0.04545f, 0.06061f, 0.09091f, -0.06061f },
    { -0.6263f,  0.5505f,  0.8485f,  0.5859f, 0.08081f, -0.3485f, -0.3838f,  0.2929f },
    {  0.2929f, -0.3838f, -0.3485f, 0.08081f,  0.5859f,  0.8485f,  0.5505f, -0.6263f },
    { -0.06061f, 0.09091f, 0.06061f, -0.04545f, -0.1212f, -0.06061f,  0.2424f,  0.8939f }
};

const float kBezier7To2[3][8] = 
{
    {  0.7083f,   0.375f,   0.125f, -0.04167f,  -0.125f,  -0.125f, -0.04167f,   0.125f },
    { -0.4583f, 0.04167f,   0.375f,  0.5417f,  0.5417f,   0.375f, 0.04167f, -0.4583f },
    {   0.125f, -0.04167f,  -0.125f,  -0.125f, -0.04167f,   0.125f,   0.375f,  0.7083f }
};


// Matrices for upsampling lower-order Bezier to order-7 Bezier

const float kBezier6To7[8][7] = 
{
    {       1f, 4.169e-05f, 6.097e-05f, 6.4e-05f, 5.545e-05f, 3.815e-05f, 1.83e-05f },
    {  0.1428f,  0.8569f, -0.0003393f, -0.0003679f, -0.000329f, -0.000216f, -0.0001011f },
    { 0.0001868f,  0.2862f,   0.715f, 0.0007339f, 0.0006597f, 0.0004478f, 0.0001926f },
    { -0.0001547f, -0.0003878f,   0.428f,  0.5708f, -0.0005083f, -0.0003328f, -0.0001335f },
    { 4.785e-05f, 0.0002131f, 0.0002516f,  0.5716f,  0.4288f, 0.0001297f, 3.815e-05f },
    { -1.309e-05f, -4.418e-05f, -6.217e-05f, -4.697e-05f,  0.7142f,  0.2857f,       0f },
    { 1.293e-06f, 1.273e-05f, 2.033e-05f, 1.776e-05f, 2.027e-05f,  0.8572f,  0.1429f },
    { 5.378e-08f, -1.566e-06f, -1.58e-06f, -5.662e-07f, -2.265e-06f, -1.192e-06f,       1f }
};

const float kBezier5To7[8][6] = 
{
    {       1f, 5.386e-05f, 7.119e-05f, 6.958e-05f, 4.995e-05f, 2.444e-05f },
    {  0.2856f,   0.714f, -0.0004087f, -0.0004001f, -0.0002911f, -0.0001397f },
    { 0.04787f,  0.4768f,   0.477f, 0.000823f, 0.0005894f, 0.000267f },
    { -0.0002035f,  0.1423f,  0.5708f,   0.285f, -0.0004864f, -0.0002136f },
    { 8.555e-05f, 0.0002152f,   0.286f,  0.5717f,  0.1431f, 8.774e-05f },
    { -1.028e-05f, -7.272e-05f, -4.399e-05f,  0.4761f,  0.4762f, 0.04762f },
    { -3.725e-09f, 1.666e-05f, 2.182e-05f, 1.884e-05f,  0.7143f,  0.2857f },
    { 2.1e-07f, -1.598e-06f, -1.147e-06f, -1.788e-06f, -4.768e-07f,       1f }
};

const float kBezier4To7[8][5] = 
{
    {       1f, 7.355e-05f, 8.455e-05f, 6.802e-05f, 3.505e-05f },
    {  0.4284f,   0.571f, -0.0004806f, -0.0003976f, -0.0002027f },
    {  0.1432f,  0.5723f,  0.2867f, 0.0007901f, 0.000391f },
    { 0.02826f,  0.3422f,  0.5135f,  0.1136f, -0.0003242f },
    { 0.0001441f,  0.1146f,  0.5147f,  0.3431f, 0.02869f },
    { -2.635e-05f, -9.06e-05f,  0.2857f,  0.5714f,  0.1428f },
    { 2.183e-06f, 2.509e-05f, 2.527e-05f,  0.5714f,  0.4286f },
    { -2.887e-07f, -2.19e-06f, -3.874e-06f, -1.907e-06f,       1f }
};

const float kBezier3To7[8][4] = 
{
    {       1f, 9.539e-05f, 9.234e-05f, 5.221e-05f },
    {  0.5711f,   0.428f, -0.0005356f, -0.0003018f },
    {  0.2863f,  0.5725f,  0.1439f, 0.0005932f },
    {  0.1138f,  0.5134f,   0.342f,  0.0281f },
    { 0.02878f,  0.3433f,  0.5147f,  0.1145f },
    { -2.614e-05f,  0.1428f,  0.5713f,  0.2857f },
    { 1.037e-05f, 2.766e-05f,  0.4286f,  0.5714f },
    { 1.751e-07f, -2.414e-06f, -4.411e-06f,       1f }
};

const float kBezier2To7[8][3] = 
{
    {       1f, 0.0001268f, 8.518e-05f },
    {  0.7138f,   0.285f, -0.0004811f },
    {  0.4772f,  0.4777f, 0.04856f },
    {   0.285f,  0.5703f,   0.142f },
    {  0.1432f,   0.572f,  0.2861f },
    {  0.0476f,  0.4761f,  0.4761f },
    { 1.544e-05f,  0.2858f,  0.7143f },
    { -7.6e-07f, -3.219e-06f,       1f }
};


// Matrix for evaluating L2 difference between two order-7 Bezier basis functions

// L2(c1, c2) = sqrt((c1 - c2)t M (c1 - c2)
//            = sqrt(dot(c1 - c2, kBezierError7 * (c1 - c2)) 

const float kBezierError7[8][8] = 
{
    { 0.066667f, 0.033333f, 0.015385f, 0.0064103f, 0.002331f, 0.0006993f, 0.0001554f, 1.9425e-05f },
    { 0.033333f, 0.035897f, 0.026923f, 0.016317f, 0.0081585f, 0.0032634f, 0.00095183f, 0.0001554f },
    { 0.015385f, 0.026923f, 0.029371f, 0.024476f, 0.016317f, 0.0085664f, 0.0032634f, 0.0006993f },
    { 0.0064103f, 0.016317f, 0.024476f, 0.027195f, 0.023796f, 0.016317f, 0.0081585f, 0.002331f },
    { 0.002331f, 0.0081585f, 0.016317f, 0.023796f, 0.027195f, 0.024476f, 0.016317f, 0.0064103f },
    { 0.0006993f, 0.0032634f, 0.0085664f, 0.016317f, 0.024476f, 0.029371f, 0.026923f, 0.015385f },
    { 0.0001554f, 0.00095183f, 0.0032634f, 0.0081585f, 0.016317f, 0.026923f, 0.035897f, 0.033333f },
    { 1.9425e-05f, 0.0001554f, 0.0006993f, 0.002331f, 0.0064103f, 0.015385f, 0.033333f, 0.066667f }
};

// Matrix for converting integrals v order-7 Bezier basis functions to corresponding Bezier coefficients

const float kToBezier7[8][8] = 
{
    {         64f,   -2.2e+02f,    4.5e+02f,   -5.6e+02f,    4.5e+02f,   -2.2e+02f,         64f,         -8f },
    {   -2.2e+02f,    1.2e+03f,   -2.9e+03f,    3.9e+03f,   -3.3e+03f,    1.7e+03f,     -5e+02f,         64f },
    {    4.5e+02f,   -2.9e+03f,    7.7e+03f,   -1.2e+04f,      1e+04f,   -5.6e+03f,    1.7e+03f,   -2.2e+02f },
    {   -5.6e+02f,    3.9e+03f,   -1.2e+04f,    1.9e+04f,   -1.8e+04f,      1e+04f,   -3.3e+03f,    4.5e+02f },
    {    4.5e+02f,   -3.3e+03f,      1e+04f,   -1.8e+04f,    1.9e+04f,   -1.2e+04f,    3.9e+03f,   -5.6e+02f },
    {   -2.2e+02f,    1.7e+03f,   -5.6e+03f,      1e+04f,   -1.2e+04f,    7.7e+03f,   -2.9e+03f,    4.5e+02f },
    {         64f,     -5e+02f,    1.7e+03f,   -3.3e+03f,    3.9e+03f,   -2.9e+03f,    1.2e+03f,   -2.2e+02f },
    {         -8f,         64f,   -2.2e+02f,    4.5e+02f,   -5.6e+02f,    4.5e+02f,   -2.2e+02f,         64f }
};
