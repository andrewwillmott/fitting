//
// Matrices for converting to and from an order-7 Bezier.
//


// Matrices for approximating order-7 Bezier by lower order Bezier

const float kBezier7To6[7][8] = 
{
    {  0.9997f,  0.0020f, -0.0061f,  0.0102f, -0.0102f,  0.0061f, -0.0020f,  0.0003f },
    { -0.1642f,  1.1497f,  0.0510f, -0.0850f,  0.0850f, -0.0510f,  0.0170f, -0.0024f },
    {  0.0571f, -0.3999f,  1.1997f,  0.3339f, -0.3338f,  0.2004f, -0.0667f,  0.0096f },
    { -0.0250f,  0.1750f, -0.5250f,  0.8749f,  0.8750f, -0.5251f,  0.1750f, -0.0250f },
    {  0.0095f, -0.0668f,  0.2003f, -0.3338f,  0.3338f,  1.1997f, -0.3999f,  0.0571f },
    { -0.0024f,  0.0170f, -0.0510f,  0.0850f, -0.0850f,  0.0510f,  1.1497f, -0.1642f },
    {  0.0003f, -0.0020f,  0.0061f, -0.0102f,  0.0102f, -0.0061f,  0.0020f,  0.9997f }
};

const float kBezier7To5[6][8] = 
{
    {  0.9959f,  0.0210f, -0.0402f,  0.0291f,  0.0087f, -0.0280f,  0.0169f, -0.0035f },
    { -0.3690f,  1.2390f,  0.3147f, -0.2442f, -0.0361f,  0.1899f, -0.1193f,  0.0251f },
    {  0.1850f, -0.7932f,  0.8752f,  1.0489f, -0.0565f, -0.5615f,  0.3857f, -0.0834f },
    { -0.0835f,  0.3857f, -0.5615f, -0.0565f,  1.0489f,  0.8752f, -0.7932f,  0.1850f },
    {  0.0251f, -0.1193f,  0.1899f, -0.0361f, -0.2442f,  0.3147f,  1.2390f, -0.3690f },
    { -0.0035f,  0.0169f, -0.0280f,  0.0087f,  0.0291f, -0.0402f,  0.0210f,  0.9959f }
};

const float kBezier7To4[5][8] = 
{
    {  0.9735f,  0.0947f, -0.0947f, -0.0189f,  0.0568f,  0.0265f, -0.0568f,  0.0189f },
    { -0.5644f,  1.0644f,  0.7576f, -0.0000f, -0.3599f, -0.1098f,  0.3258f, -0.1136f },
    {  0.3106f, -0.8030f,  0.0455f,  0.9470f,  0.9470f,  0.0455f, -0.8030f,  0.3106f },
    { -0.1136f,  0.3258f, -0.1098f, -0.3598f, -0.0000f,  0.7576f,  1.0644f, -0.5644f },
    {  0.0189f, -0.0568f,  0.0265f,  0.0568f, -0.0189f, -0.0947f,  0.0947f,  0.9735f }
};

const float kBezier7To3[4][8] = 
{
    {  0.8939f,  0.2424f, -0.0606f, -0.1212f, -0.0455f,  0.0606f,  0.0909f, -0.0606f },
    { -0.6263f,  0.5505f,  0.8485f,  0.5859f,  0.0808f, -0.3485f, -0.3838f,  0.2929f },
    {  0.2929f, -0.3838f, -0.3485f,  0.0808f,  0.5859f,  0.8485f,  0.5505f, -0.6263f },
    { -0.0606f,  0.0909f,  0.0606f, -0.0455f, -0.1212f, -0.0606f,  0.2424f,  0.8939f }
};

const float kBezier7To2[3][8] = 
{
    {  0.7083f,  0.3750f,  0.1250f, -0.0417f, -0.1250f, -0.1250f, -0.0417f,  0.1250f },
    { -0.4583f,  0.0417f,  0.3750f,  0.5417f,  0.5417f,  0.3750f,  0.0417f, -0.4583f },
    {  0.1250f, -0.0417f, -0.1250f, -0.1250f, -0.0417f,  0.1250f,  0.3750f,  0.7083f }
};


// Matrices for upsampling lower-order Bezier to order-7 Bezier

const float kBezier6To7[8][7] = 
{
    {  1.0000f,  0.0000f,  0.0001f,  0.0001f,  0.0001f,  0.0000f,  0.0000f },
    {  0.1428f,  0.8569f, -0.0003f, -0.0004f, -0.0003f, -0.0002f, -0.0001f },
    {  0.0002f,  0.2862f,  0.7150f,  0.0007f,  0.0007f,  0.0004f,  0.0002f },
    { -0.0002f, -0.0004f,  0.4280f,  0.5708f, -0.0005f, -0.0003f, -0.0001f },
    {  0.0000f,  0.0002f,  0.0003f,  0.5716f,  0.4288f,  0.0001f,  0.0000f },
    { -0.0000f, -0.0000f, -0.0001f, -0.0000f,  0.7142f,  0.2857f,  0.0000f },
    {  0.0000f,  0.0000f,  0.0000f,  0.0000f,  0.0000f,  0.8572f,  0.1429f },
    {  0.0000f, -0.0000f, -0.0000f, -0.0000f, -0.0000f, -0.0000f,  1.0000f }
};

const float kBezier5To7[8][6] = 
{
    {  1.0000f,  0.0001f,  0.0001f,  0.0001f,  0.0000f,  0.0000f },
    {  0.2856f,  0.7140f, -0.0004f, -0.0004f, -0.0003f, -0.0001f },
    {  0.0479f,  0.4768f,  0.4770f,  0.0008f,  0.0006f,  0.0003f },
    { -0.0002f,  0.1423f,  0.5708f,  0.2850f, -0.0005f, -0.0002f },
    {  0.0001f,  0.0002f,  0.2860f,  0.5717f,  0.1431f,  0.0001f },
    { -0.0000f, -0.0001f, -0.0000f,  0.4761f,  0.4762f,  0.0476f },
    { -0.0000f,  0.0000f,  0.0000f,  0.0000f,  0.7143f,  0.2857f },
    {  0.0000f, -0.0000f, -0.0000f, -0.0000f, -0.0000f,  1.0000f }
};

const float kBezier4To7[8][5] = 
{
    {  1.0000f,  0.0001f,  0.0001f,  0.0001f,  0.0000f },
    {  0.4284f,  0.5710f, -0.0005f, -0.0004f, -0.0002f },
    {  0.1432f,  0.5723f,  0.2867f,  0.0008f,  0.0004f },
    {  0.0283f,  0.3422f,  0.5135f,  0.1136f, -0.0003f },
    {  0.0001f,  0.1146f,  0.5147f,  0.3431f,  0.0287f },
    { -0.0000f, -0.0001f,  0.2857f,  0.5714f,  0.1428f },
    {  0.0000f,  0.0000f,  0.0000f,  0.5714f,  0.4286f },
    { -0.0000f, -0.0000f, -0.0000f, -0.0000f,  1.0000f }
};

const float kBezier3To7[8][4] = 
{
    {  1.0001f,  0.0001f,  0.0001f,  0.0001f },
    {  0.5711f,  0.4280f, -0.0005f, -0.0003f },
    {  0.2863f,  0.5725f,  0.1439f,  0.0006f },
    {  0.1138f,  0.5134f,  0.3420f,  0.0281f },
    {  0.0288f,  0.3433f,  0.5147f,  0.1145f },
    { -0.0000f,  0.1428f,  0.5713f,  0.2857f },
    {  0.0000f,  0.0000f,  0.4286f,  0.5714f },
    {  0.0000f, -0.0000f, -0.0000f,  1.0000f }
};

const float kBezier2To7[8][3] = 
{
    {  1.0001f,  0.0001f,  0.0001f },
    {  0.7138f,  0.2850f, -0.0005f },
    {  0.4772f,  0.4777f,  0.0486f },
    {  0.2850f,  0.5703f,  0.1420f },
    {  0.1432f,  0.5720f,  0.2861f },
    {  0.0476f,  0.4761f,  0.4761f },
    {  0.0000f,  0.2858f,  0.7143f },
    { -0.0000f, -0.0000f,  1.0000f }
};


// Matrix for evaluating L2 difference between two order-7 Bezier basis functions

// L2(c1, c2) = sqrt((c1 - c2)t M (c1 - c2)
//            = sqrt(dot(c1 - c2, kBezierError7 * (c1 - c2)) 

const float kBezierError7[8][8] = 
{
    { 0.06667f, 0.03333f, 0.01538f, 0.00641f, 0.00233f, 0.00070f, 0.00016f, 0.00002f },
    { 0.03333f, 0.03590f, 0.02692f, 0.01632f, 0.00816f, 0.00326f, 0.00095f, 0.00016f },
    { 0.01538f, 0.02692f, 0.02937f, 0.02448f, 0.01632f, 0.00857f, 0.00326f, 0.00070f },
    { 0.00641f, 0.01632f, 0.02448f, 0.02720f, 0.02380f, 0.01632f, 0.00816f, 0.00233f },
    { 0.00233f, 0.00816f, 0.01632f, 0.02380f, 0.02720f, 0.02448f, 0.01632f, 0.00641f },
    { 0.00070f, 0.00326f, 0.00857f, 0.01632f, 0.02448f, 0.02937f, 0.02692f, 0.01538f },
    { 0.00016f, 0.00095f, 0.00326f, 0.00816f, 0.01632f, 0.02692f, 0.03590f, 0.03333f },
    { 0.00002f, 0.00016f, 0.00070f, 0.00233f, 0.00641f, 0.01538f, 0.03333f, 0.06667f }
};

// Matrix for converting integrals v order-7 Bezier basis functions to corresponding Bezier coefficients

const float kToBezier7[8][8] = 
{
    {      64.00f,    -224.02f,     448.05f,    -560.09f,     448.09f,    -224.05f,      64.02f,      -8.00f },
    {    -224.02f,    1216.13f,   -2864.38f,    3904.61f,   -3296.61f,    1710.07f,    -501.83f,      64.02f },
    {     448.05f,   -2864.39f,    7745.15f,  -11553.88f,   10379.01f,   -5631.95f,    1710.07f,    -224.05f },
    {    -560.09f,    3904.65f,  -11553.94f,   18773.46f,  -18086.55f,   10378.97f,   -3296.59f,     448.08f },
    {     448.09f,   -3296.66f,   10379.09f,  -18086.62f,   18773.42f,  -11553.83f,    3904.59f,    -560.08f },
    {    -224.06f,    1710.11f,   -5632.03f,   10379.06f,  -11553.88f,    7745.10f,   -2864.35f,     448.05f },
    {      64.02f,    -501.85f,    1710.10f,   -3296.64f,    3904.62f,   -2864.36f,    1216.12f,    -224.02f },
    {      -8.00f,      64.02f,    -224.06f,     448.09f,    -560.09f,     448.05f,    -224.02f,      64.00f }
};
